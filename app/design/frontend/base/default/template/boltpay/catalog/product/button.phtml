<?php
/**
 * Bolt magento plugin
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * @category   Bolt
 * @package    Bolt_Boltpay
 * @copyright  Copyright (c) 2019 Bolt Financial, Inc (https://www.bolt.com)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */


/* @var $this Bolt_Boltpay_Block_Catalog_Product_Boltpay */
?>
<?php if ($this->isEnabledProductPageCheckout()): ?>
    <style>
<!--
.disabledbutton {
    pointer-events: none;
    opacity: 0.4;
}
-->
</style>
    <?php if ($this->isSupportedProductType()):?>
    <?php $token = $this->getBoltToken(new Bolt_Boltpay_Model_BoltOrder(), new Bolt_Boltpay_Helper_CatalogHelper());?>
    <?php if ($token):?>
    <div class="bolt-product-checkout-button" data-btn-txt="Buy now"></div>
        <div id="ppcBuyNow" title="PPC" class="button btn-cart validation-passed disabledbutton" style="display: none;">
        <span>
            <span><?php echo $this->__('Processing ...') ?></span>
        </span>
    </div>
    
        <script type="text/javascript">
        jQuery(document).ready(function() {
                var cart = {
                    "orderToken": "<?php echo $token;?>"
                };
                var hints = {};
                var callbacks = {};
                BoltCheckout.configureProductCheckout(cart, hints, callbacks);
        });
        </script>
    <?php endif;?>
    <?php else:?>
    <div class="bolt-product-checkout-button"></div>
    <div id="ppcBuyNow" title="PPC" class="button btn-cart validation-passed" onclick="productPageCheckout.click(this)">
        <span>
            <span><?php echo $this->__('Buy Now') ?></span>
        </span>
    </div>
    <?php endif;?>
<?php endif; ?>
